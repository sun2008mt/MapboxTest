<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'/>
    <title></title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no'/>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.33.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.33.1/mapbox-gl.css' rel='stylesheet'/>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>
<body>

<div id='map'></div>
<script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoic3VuMjAwODA4MDhtdCIsImEiOiJhZDNiZDk3NmVkMjU2MmViODE4OGUwNzBjNTI0Yzk0MCJ9.ErUAk5LPIVLPa8NWaID7bg';
    var map = new mapboxgl.Map({
        container: 'map',
//        style: 'mapbox://styles/mapbox/basic-v9',
        style: {
            version: 8,
            sources: {},
            layers: []
        },
        center: [114.348864, 30.58394],
        zoom: 15
    });

    map.on('load', function () {
//        map.addSource('line', {
//            "type": "geojson",
//            "data": {
//                "type": "Feature",
//                "properties": {},
//                "geometry": {
//                    "type": "LineString",
//                    "coordinates": [
//                        [-122.48369693756104, 37.83381888486939],
//                        [-122.48348236083984, 37.83317489144141],
//                        [-122.48339653015138, 37.83270036637107],
//                        [-122.48356819152832, 37.832056363179625],
//                        [-122.48404026031496, 37.83114119107971],
//                        [-122.48404026031496, 37.83049717427869],
//                        [-122.48348236083984, 37.829920943955045],
//                        [-122.48356819152832, 37.82954808664175],
//                        [-122.48507022857666, 37.82944639795659],
//                        [-122.48610019683838, 37.82880236636284],
//                        [-122.48695850372314, 37.82931081282506],
//                        [-122.48700141906738, 37.83080223556934],
//                        [-122.48751640319824, 37.83168351665737],
//                        [-122.48803138732912, 37.832158048267786],
//                        [-122.48888969421387, 37.83297152392784],
//                        [-122.48987674713133, 37.83263257682617],
//                        [-122.49043464660643, 37.832937629287755],
//                        [-122.49125003814696, 37.832429207817725],
//                        [-122.49163627624512, 37.832564787218985],
//                        [-122.49223709106445, 37.83337825839438],
//                        [-122.49378204345702, 37.83368330777276]
//                    ]
//                }
//            }
//        });


        map.addSource('line', {
            "type": "geojson",
            "data": {
                "type": "Feature",
                "properties": {},
                "geometry": {
                    "type": "MultiLineString",
                    "coordinates": [
                        [[114.348956153, 30.58464439861], [114.34894230091, 30.58463023602]],
                        [[114.34894230091, 30.58463023602], [114.34897705443, 30.58460679429]],
                        [[114.34897705443, 30.58460679429], [114.34901135257, 30.58458365972]],
                        [[114.34901135257, 30.58458365972], [114.34903580409, 30.58456716683]],
                        [[114.34903580409, 30.58456716683], [114.34905566014, 30.58455377365], [114.34909054125, 30.58452543275]],
                        [[114.34909054125, 30.58452543275], [114.34910030432, 30.58451750025]],
                        [[114.34910030432, 30.58451750025], [114.34911857699, 30.58450265371]],
                        [[114.34911857699, 30.58450265371], [114.34917381869, 30.58445776982]],
                        [[114.34917381869, 30.58445776982], [114.34923517369, 30.58440791889]],
                        [[114.34927319687, 30.58447186122], [114.34923517369, 30.58440791889]]
                    ]

                }
            }
        });

        map.addSource('area', {
            type: 'geojson',
            data: {
                "type": "Feature",
                "geometry": {
                    "type": "MultiPolygon",
                    "coordinates": [
                        [
                            [
                                [114.348864, 30.58394],
                                [114.348878, 30.583949],
                                [114.348901, 30.583925],
                                [114.348889, 30.583916],
                                [114.348864, 30.58394]
                            ]
                        ]
                    ]
                }
            }
        });

        map.addSource('floor', {
            type: 'geojson',
            data: {
                "type": "Feature",
                "geometry": {
                    "type": "MultiPolygon",
                    "coordinates": [
                        [
                            [
                                [114.347818, 30.584257], [114.347881, 30.584299], [114.34794, 30.584339], [114.348303, 30.58459], [114.348532, 30.584746], [114.348599, 30.58468], [114.348743, 30.58468], [114.348743, 30.5847], [114.348808, 30.584766], [114.348802, 30.584771], [114.348844, 30.584814], [114.348979, 30.584953], [114.349077, 30.585052], [114.349149, 30.585002], [114.349142, 30.584994], [114.349161, 30.58498], [114.349338, 30.584858], [114.34936, 30.584842], [114.349368, 30.58485], [114.349395, 30.584831], [114.349469, 30.58478], [114.349636, 30.584665], [114.349742, 30.584592], [114.349857, 30.584512], [114.349892, 30.584483], [114.349922, 30.584462], [114.349973, 30.584426], [114.350011, 30.584387], [114.349886, 30.584302], [114.349741, 30.584182], [114.349825, 30.5841], [114.349625, 30.583964], [114.349587, 30.583938], [114.349562, 30.583921], [114.349535, 30.583903], [114.349442, 30.58384], [114.349287, 30.583734], [114.34928, 30.58374], [114.349253, 30.583722], [114.349223, 30.583702], [114.349215, 30.583696], [114.349212, 30.583694], [114.349219, 30.583687], [114.349197, 30.583672], [114.349172, 30.583655], [114.34902, 30.583552], [114.348985, 30.583528], [114.348946, 30.583502], [114.348939, 30.583509], [114.34892, 30.583496], [114.348891, 30.583475], [114.348886, 30.583472], [114.348893, 30.583465], [114.348709, 30.58334], [114.348626, 30.583421], [114.3485, 30.583414], [114.348437, 30.583371], [114.348358, 30.583499], [114.348338, 30.583534], [114.348349, 30.583539], [114.348337, 30.583559], [114.348303, 30.583615], [114.348296, 30.583626], [114.348286, 30.583623], [114.348247, 30.583688], [114.348141, 30.58386], [114.348148, 30.583863], [114.348111, 30.583922], [114.348105, 30.583919], [114.348069, 30.583979], [114.348029, 30.584043], [114.348047, 30.584056], [114.348002, 30.584099], [114.347977, 30.584124], [114.347913, 30.584186], [114.347901, 30.584197], [114.347893, 30.584192], [114.347888, 30.584189], [114.347875, 30.584202], [114.347818, 30.584257]
                            ]
                        ]
                    ]
                },
                "properties": {
                    "Tr": "1F",
                    "id": "ZH0000060110100001",
                    "Vr": "000200",
                    "Wr": 1,
                    "T": "floor",
                    "category": "floor"
                },
                "order": 1
            }
        });
//        map.addSource('line', {
//            "type": "geojson",
//            "data": {
//                "type": "Feature",
//                "properties": {},
//                "geometry": {
//                    "type": "MultiLineString",
//                    "coordinates": [
//                        [[-122.48369693756104, 37.83381888486939],
//                        [-122.48348236083984, 37.83317489144141],
//                        [-122.48339653015138, 37.83270036637107],
//                        [-122.48356819152832, 37.832056363179625],
//                        [-122.48404026031496, 37.83114119107971],
//                        [-122.48404026031496, 37.83049717427869],
//                        [-122.48348236083984, 37.829920943955045],
//                        [-122.48356819152832, 37.82954808664175],
//                        [-122.48507022857666, 37.82944639795659],
//                        [-122.48610019683838, 37.82880236636284]],
//
//                        [[-122.48695850372314, 37.82931081282506],
//                        [-122.48700141906738, 37.83080223556934],
//                        [-122.48751640319824, 37.83168351665737],
//                        [-122.48803138732912, 37.832158048267786],
//                        [-122.48888969421387, 37.83297152392784],
//                        [-122.48987674713133, 37.83263257682617],
//                        [-122.49043464660643, 37.832937629287755],
//                        [-122.49125003814696, 37.832429207817725],
//                        [-122.49163627624512, 37.832564787218985],
//                        [-122.49223709106445, 37.83337825839438],
//                        [-122.49378204345702, 37.83368330777276]]
//                    ]
//                }
//            }
//        });

        map.addLayer({
            "id": "floor",
            "type": "fill",
            "source": 'floor',
            "layout": {},
            "paint": {
                "fill-color": "blue"
            }
        });

        map.addLayer({
            "id": "route",
            "type": "line",
            "source": 'line',
            "layout": {
                "line-join": "round",
                "line-cap": "round"
            },
            "paint": {
                "line-color": "red",
                "line-width": 12
            }
        });

//        map.addLayer({
//            id: 'arrow',
//            type: 'symbol',
//            source: 'line',
//            layout: {
//                "icon-image": "star-15",
//                "icon-size": 1,
//                "symbol-placement": 'line',
//                "symbol-spacing": 1,
//                "symbol-avoid-edges": false,
//                "icon-allow-overlap": false
//            }
////            ,
////            filter: ['==', '$type', 'LineString']
//        })

        map.addLayer({
            "id": "area",
            "type": "fill",
            "source": 'area',
            "layout": {},
            "paint": {
                "fill-color": "green"
            }
        });

        map.addLayer({
            id: 'test',
            type: 'fill',
            source: {
                type: 'geojson',
                data: {
                    "type": "Feature",
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": [
                            [
                                [
                                    [114.34902, 30.584855],
                                    [114.348949, 30.584904],
                                    [114.34899, 30.584945],
                                    [114.349005, 30.584935],
                                    [114.34901, 30.584941],
                                    [114.349067, 30.584902]
                                ]
                            ]
                        ]
                    },
                    "properties": {
                        "category": "shop",
                        "Sb": "",
                        "ub": "",
                        "T": "16",
                        "P": "shoparea0",
                        "Yr": "",
                        "U": []
                    },
                    "order": 3
                }
            },
            "layout": {},
            "paint": {
                "fill-color": "yellow"
            }
        });

        map.flyTo({
            center: [114.34909054125, 30.58452543275],
            zoom: 18
        });
    });
</script>

</body>
</html>